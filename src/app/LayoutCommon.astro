---
import pkg from '../../package.json' assert { type: 'json' };
import { pathRoutes } from '../config/pathRoutes';
import { url } from '../lib/data.js';
import { supabase } from '../supabase';

import { SITE_TITLE } from './constants.js';

const { class: clazz } = Astro.props;

const baseUrl = process.env.PUBLIC_BASE_URL || import.meta.env.PUBLIC_BASE_URL
const encryptKey = process.env.PUBLIC_CRYPTO_PRIVATE_KEY || import.meta.env.PUBLIC_CRYPTO_PRIVATE_KEY

if (
	pathRoutes.auth.signUp !== Astro.url.pathname &&
	pathRoutes.auth.sinIn !== Astro.url.pathname &&
	pathRoutes.auth.verifyEmail !== Astro.url.pathname
) {
	
	// else {
	// 	const response = await fetch('/api/auth/signout', {
	// 		method: "GET",
	// 		headers: {
	// 			"Content-Type": "application/json",
	// 		}
	// 	});

	// 	if (response.redirected) {
	// 		window.location.assign(response.url);
	// 	}

	// }
}

---

<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>{SITE_TITLE} — v{pkg.version}</title>
	<!-- <ViewTransitions fallback="swap"/> -->

	<meta name="generator" content={Astro.generator} />
	<meta name="description" content={pkg.description} />
	<meta name="" content={pkg.description} />
	<link rel="icon" type="image/svg+xml" href={url('favicon.svg')} />
	<link rel="sitemap" type="application/xml" href={url('sitemap-index.xml')} />

	<meta name="author" content="Julian Cataldo, Zoltán Szőgyényi, Robert Tanislav" />
	<meta name="copyright" content="MIT" />

	<script is:inline>
			if (
				localStorage.getItem('color-theme') === 'dark' ||
				(!('color-theme' in localStorage) &&
					window.matchMedia('(prefers-color-scheme: dark)').matches)
			) {
				document.documentElement.classList.add('dark');
			} else {
				document.documentElement.classList.remove('dark');
			}
		</script>
</head>

<body class:list={[ // clazz, 'bg-gray-50 dark:bg-gray-800'
	, 'scrollbar scrollbar-w-3 scrollbar-thumb-rounded-[0.25rem]'
	, 'scrollbar-track-slate-200  scrollbar-thumb-gray-400'
	, 'dark:scrollbar-track-gray-900 dark:scrollbar-thumb-gray-700' , ]}>
	<slot />
</body>

</html>

<script>
	import 'flowbite';
	import 'flowbite/dist/datepicker.js';
</script>

<script define:vars={{ baseUrl, encryptKey }}>
	globalThis.baseUrl = baseUrl;
	globalThis.encryptKey = encryptKey;
</script>

<style is:global>
	@import url('https://fonts.cdnfonts.com/css/inter');
</style>